# 04.16 독서 인증

---
## 테스트 주도 개발 시작하기 (60 - 138)

---

### 테스트 코드 작성 순서
- 테스트 코드 작성 순서
    - 쉬운 경우 -> 어려운 경우
    - 예외적인 경우 -> 일반적인 경우
- 왜 다음과 같은 순서로 해야하는가?
    - 너무 구현이 어려운 기능 먼저 테스트를 진행하게 되면 한번에 너무많은 구현 코드를 작성해야함 -> 흐름이 자주 끊기게 됨, 잦은 버그 발생
    - 하지만 쉬운 구현을 먼저 작성하게 된다면? 한번에 구현하는 시간이 짧아져 디버깅할 때 유리하다. 또한, 흐름이 끊기지 않기 때문에 점진적인 구현에 원동력을 준다.
    - 예외 상황을 먼저 테스트하지 않으면 많은 코드가 작성된 이후에 복잡한 if-else 블록이 들어가 코드를 더욱 복잡하게 만든다. 하지만 예외 상황을 먼저 테스트한다면 이후 추가되는 코드가 줄어 코드 구조가 덜 바뀌게 된다. 
- 완급 조절의 중요성
    - 한번에 너무 많은 기능을 구현하려고 하는 것은 좋지 않다. 해당 테스트를 통과할 만큼의 최소한의 구현만을 작성한다.
    - 이후에는 다양한 테스트를 추가하면서 해당 구현을 일반화한다.
- 테스트 코드도 코드다. 리팩토링을 통해 가독성을 늘릴 필요가 있다.
- 테스트 과정에서 새로운 테스트 사례를 발견하면 해당 사례를 목록에 추가해서 놓치지 않도록 한다. ( README나 패드에 적어놓자 )

### TDD-기능 명세-설계
- 요구사항에 대한 설계 이후에 TDD를 진행하게 된다. TDD를 하다보면 클래스 이름, 메서드 이름, 파라미터, 결과값에 대한 설계를 하게된다. 따라서 TDD 자체가 설계는 아니지만 TDD 하다보면 일부 설계를 진행하게 된다.
- TDD에서는 테스트를 통과할 만큼만 코드를 작성한다. 필요할 것으로 예측해서 미리 코드를 만들지 않는다.
- 테스트 코드를 작성하기 위해 기능 명세를 자세하게 정리하는 것이 필요하다.
- 개발자는 요구사항에서 최대한 예외적인 상황, 복잡한 상황에 해당하는 구체적인 예를 끄집어낼 수 있어야한다.

### JUnit 5기초
- 여기서 새로 배운 내용은 테스트 코드가 실행되는 순서였다.
    - 테스트 코드는 실행될 때마다 새 객체를 생성한다.
    - 즉, 생성자의 내용이 매 테스트마다 실행되고 이후 `@BeforeEach -> @Test 메서드 -> @AfterEach` 순으로 진행된다.
    - 생성자가 계속 실행될 줄은 몰랐다.
    - `@BeforeAll` 과 `@AfterAll` 에는 정적 메서드를 붙인다.

- 테스트 메서드 간에는 실행 순서를 의존하면 안되고 필드를 공유하면 안된다.
    - 각 테스트 메서드는 서로 독립적으로 동작해야한다.
    - 테스트 메서드 간에 의존이 생기면 유지보수가 어렵다. 테스트 코드도 역시 코드이므로 유지보수가 중요하다.
- `@Disabled` 애노테이션을 이용해 테스트 대상에서 제외할 수 있다.
- `AssertAll` 은 내부에 존재하는 단언문을 모두 수행한 뒤에 실패, 성공을 표시해준다.

### 테스트 코드의 구성
- 테스트 코드는 상황, 실행, 결과확인 순서로 주로 구성된다.
    - given, when, then
- 테스트는 언제 실행해도 항상 정상적으로 동작하는 것이 중요하다.
- 외부 상태가 테스트 결과에 영향을 주지 않도록 작성해야한다.
    - 예로 DB에 의존한 환경이라면 DB에 삽입한 뒤 이를 삭제해주는 작업을 하던가, 롤백을 하던가의 작업을 진행해준다.
- 외부 요인을 테스트하기 어려울 경우 대역을 이용할 수 있다.
